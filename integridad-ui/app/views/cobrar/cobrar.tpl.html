<div style="width: 100%;height: 100%;top: 0px;left: 0px;position: fixed;display: block; z-index: 99; background: rgba(255, 255, 255, 0.3)" ng-show="vm.loading">
    <div style="position: absolute;top: 15%;z-index: 100; width: 100%; text-align: center;">
        <div class="sk-circle">
            <div class="sk-circle1 sk-child"></div>
            <div class="sk-circle2 sk-child"></div>
            <div class="sk-circle3 sk-child"></div>
            <div class="sk-circle4 sk-child"></div>
            <div class="sk-circle5 sk-child"></div>
            <div class="sk-circle6 sk-child"></div>
            <div class="sk-circle7 sk-child"></div>
            <div class="sk-circle8 sk-child"></div>
            <div class="sk-circle9 sk-child"></div>
            <div class="sk-circle10 sk-child"></div>
            <div class="sk-circle11 sk-child"></div>
            <div class="sk-circle12 sk-child"></div>
        </div>
    </div>
</div>

<div class="form-group col-md-12">
    <div class="header">
        <h4><b>Cuentas Por Cobrar</b></h4>
    </div>
    
    <div class="row" ng-show="vm.error !== undefined">
        <div class="form-group col-md-12">
            <div class="alert alert-danger">{{vm.error}}</div>
        </div>
    </div>
    <div class="row" ng-show="vm.success !== undefined">
        <div class="form-group col-md-12">
            <div class="alert alert-success">{{vm.success}}</div>
        </div>
    </div>
    
    <!--SECCIÓN DE CARGA DE LOS LOS CLIENTES-->
    <div class="table-responsive" ng-show="vm.billList === undefined && vm.clientSelected === undefined && vm.multipleCobroSelected === undefined && vm.paymentList === undefined">
        <div class="row">
            <div class="form-group col-md-12">
                <input ng-model="searchText" class="form-control" placeholder="Buscar Clientes">
            </div>
        </div>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>C&oacute;digo</th>
                    <th>Nombre</th>
                    <th>No. Identidad</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-show="vm.clientList == 0">
                    <td colspan="4">
                        No hay clientes ingresados...
                    </td>
                </tr>
                <tr ng-repeat="client in vm.clientList | orderBy:'name' | filter:searchText">
                    <td>{{client.codApp}}</td>
                    <td>{{client.name}}</td>
                    <td>{{client.typeId}} - {{client.identification}}</td>
                    <td>
                        <button type = "button" title = "Seleccionar Cliente" class = "btn btn-primary btn-sm" ng-click = "vm.clientConsult(client)">
                                <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                        </button>
                        <button type = "button" title = "Pago Múltiple de Facturas" class = "btn btn-success btn-sm" ng-click = "vm.clientMultiplePayment(client)">
                                <span class = "glyphicon glyphicon-credit-card" aria-hidden = "true"></span>
                        </button>
                        <button type = "button" title = "Consultar Cobros por Cliente" class = "btn btn-primary btn-sm" ng-click = "vm.paymentsByClient(client)">
                            <span class = "glyphicon glyphicon-eye-open" aria-hidden = "true"></span>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="row">
            <div class="form-group col-md-12">
                <button type="button" title="Volver a Inicio" class="btn btn-danger btn-sm"
                        ng-click="vm.exit()">
                        <span class="glyphicon glyphicon-log-out" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>
    
    <!--SECCIÓN DE CARGA DE LAS FACTURAS DE LOS CLIENTES-->
    <div class="table-responsive" ng-show="vm.billList !== undefined && vm.retentionClient === undefined">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Listado de Facturas Pertenecientes a: {{vm.clientName}}</b>
            </div>
            <div class="panel-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>N&uacute;mero</th>
                            <th>Fecha</th>
                            <th>Total</th>
                            <th>Saldo</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-show="vm.billList == 0">
                            <td colspan="4">
                                El Cliente <b>No Presenta</b> Facturas por Cobrar...
                            </td>
                        </tr>
                        <tr ng-repeat="bill in vm.billList">
                            <td>{{bill.stringSeq}}</td>
                            <td>{{bill.dateCreated | date : "dd/MM/yyyy"}}</td>
                            <td>{{bill.total.toFixed(2)}}</td>
                            <td>{{bill.saldo}}</td>
                            <td>
                                <button type="button" title = "Pago Individual de Factura" class="btn btn-primary btn-sm" 
                                        ng-click="vm.creditsByBill(bill)" data-toggle="modal" data-target="#modalCuotas">
                                        <span class = "glyphicon glyphicon-usd" aria-hidden = "true"></span>
                                </button> 
                                <button type="button" title = "Nueva Retención" class="btn btn-success btn-sm" ng-click="vm.createRetentionClient(bill)">
                                        <span class = "glyphicon glyphicon-tasks" aria-hidden = "true"></span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="panel-footer">
                <button type="button" title = "Salir" class="btn btn-primary btn-sm" ng-click="vm.cancel()">
                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                </button>
            </div>
        </div>
    </div>
    
    <!--SECCIÓN DE CARGA DE LOS CRÉDITOS POR FACTURA-->
    <div id="modalCuotas" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Listado de Cuotas por Factura por Cobrar</h4>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Fecha Limite</th>
                                <th>N&uacute;mero de Pagos</th>
                                <th>Saldo por Cancelar</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-show="vm.creditsbillList == 0">
                                <td colspan="4">
                                    La Factura <b>No Presenta</b> Cobros Pendientes por Cancelar...
                                </td>
                            </tr>
                            <tr ng-repeat="credits in vm.creditsbillList | orderBy:'payNumber':true">
                                <td>{{credits.fecha | date : "dd/MM/yyyy"}}</td>
                                <td>{{credits.payNumber}}</td>
                                <td>{{credits.valor.toFixed(2)}}</td>
                                <td>
                                    <button type="button" title = "Abonar Pago" class="btn btn-primary btn-sm" ng-click="vm.createAbono(credits)"
                                            data-dismiss="modal" data-toggle="modal" data-target="#modalAbonar">
                                            <span class = "glyphicon glyphicon-plus" aria-hidden = "true"></span>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!--SECCIÓN DE PAGO DE LAS CUOTAS POR FACTURA-->
    <div id="modalAbonar" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Pago de Cuotas</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label>Nombre del Cliente:</label><br/>
                            <b>{{vm.clientName}}</b>
                        </div>
                        <div class="form-group col-md-6">
                            <label>Identificaci&oacute;n del Cliente:</label><br/>
                            <b>{{vm.clientIdentification}}</b><br/>
                            <b>{{vm.clientCodConta}}</b>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            <label>Fecha de Pago: </label>
                            <div class="input-group date" id="pickerDateOfPayment">
                                <input type="text" class="form-control input-group-addon"/>
                                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"/></span>
                            </div>
                            <script>
                                var defaultDate = new Date();
                                $('#pickerDateOfPayment').datetimepicker({format: "DD/MM/YY",});
                            </script>
                        </div>
                        <div class="form-group col-md-6">
                            <label>Seleccione el Tipo de Abono:</label><br/>
                            <select ng-options="item.code as item.name for item in [{code:'PAC', name:'PAGO CORRIENTE'}, {code: 'NTC', name: 'NOTA DE CREDITO'}]"
                                    ng-model="vm.payment.typePayment" class="form-control">
                            </select>
                        </div>
                    </div>
                    <div class="row" ng-show="vm.payment.typePayment === 'PAC'">
                        <div class="form-group col-md-12">
                            <label>Seleccione Modalidad de Pago:</label><br/>
                            <label class="radio-inline"><input type="radio" ng-model="vm.payment.modePayment" 
                                   value="EFC" name="efectivo">Efectivo</label>
                            <label class="radio-inline"><input type="radio" ng-model="vm.payment.modePayment" 
                                   value="CHQ" name="cheque">Cheque</label>
                            <label class="radio-inline"><input type="radio" ng-model="vm.payment.modePayment" 
                                   value="TRF" name="transferencia">Transferencia</label>
                            <label class="radio-inline"><input type="radio" ng-model="vm.payment.modePayment" 
                                   value="TDC" name="tdc">Tarjeta de Cŕedito</label>
                            <label class="radio-inline"><input type="radio" ng-model="vm.payment.modePayment" 
                                   value="DEP" name="deposito">Depósito Bancario</label>
                        </div>
                        <div class="form-group col-md-12">
                            <div class="row" ng-show="vm.payment.modePayment === 'EFC'">
                                <div class="form-group col-md-6">
                                    <label>Detalle:</label><br/>
                                    <select ng-options="deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                            ng-model="vm.payment.detail" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Monto a Abonar:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.valorAbono" placeholder="{{vm.creditValue}}"/>
                                </div>
                            </div>
                            <div class="row" ng-show="vm.payment.modePayment === 'CHQ'">
                                <div class="form-group col-md-12" ng-show="vm.ctaCtableBankList !== undefined">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>N&uacute;mero de Cuenta</th>
                                                <th>Nombre del Banco</th>
                                                <th>Tipo de Cuenta</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-show="vm.ctaCtableBankList == 0">
                                                <td colspan="2">
                                                    No hay Cuentas Contables de Bancos Ingresadas
                                                </td>
                                            </tr>
                                            <tr dir-paginate = "cuenta in vm.ctaCtableBankList | orderBy:'description' | filter:searchTextTaxes | itemsPerPage: 3" pagination-id = "taxesPagination">
                                                <td>{{cuenta.code}}</td>
                                                <td>{{cuenta.description}}</td>
                                                <td>{{cuenta.accountType}}</td>
                                                <td>
                                                    <button type = "button" title = "Seleccionar" class = "btn btn-primary btn-sm"
                                                            ng-click = "vm.selectCtaCtableBank(cuenta)">
                                                            <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <dir-pagination-controls pagination-id = "taxesPagination"></dir-pagination-controls>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Banco:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.bankName"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>N&uacute;mero de Cheque:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noDocument"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>N&uacute;mero de Cuenta:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noAccount"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Detalle:</label><br/>
                                    <select ng-options="deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                            ng-model="vm.payment.detail" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Monto a Abonar:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.valorAbono" placeholder="{{vm.creditValue}}"/>
                                </div>
                            </div>
                            <div class="row" ng-show="vm.payment.modePayment === 'TRF'">
                                <div class="form-group col-md-12" ng-show="vm.ctaCtableBankList !== undefined">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>N&uacute;mero de Cuenta</th>
                                                <th>Nombre del Banco</th>
                                                <th>Tipo de Cuenta</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-show="vm.ctaCtableBankList == 0">
                                                <td colspan="2">
                                                    No hay Cuentas Contables de Bancos Ingresadas
                                                </td>
                                            </tr>
                                            <tr dir-paginate = "cuenta in vm.ctaCtableBankList | orderBy:'description' | filter:searchTextTaxes | itemsPerPage: 3" pagination-id = "taxesPagination">
                                                <td>{{cuenta.code}}</td>
                                                <td>{{cuenta.description}}</td>
                                                <td>{{cuenta.accountType}}</td>
                                                <td>
                                                    <button type = "button" title = "Seleccionar" class = "btn btn-primary btn-sm"
                                                            ng-click = "vm.selectCtaCtableBank(cuenta)">
                                                            <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <dir-pagination-controls pagination-id = "taxesPagination"></dir-pagination-controls>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Banco:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.bankName"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>N&uacute;mero de Transferencia:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noDocument"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>N&uacute;mero de Cuenta:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noAccount"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Detalle:</label><br/>
                                    <select ng-options="deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                            ng-model="vm.payment.detail" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Monto a Abonar:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.valorAbono" placeholder="{{vm.creditValue}}"/>
                                </div>
                            </div>
                            <div class="row" ng-show="vm.payment.modePayment === 'TDC'">
                                <div class="form-group col-md-6">
                                    <label>N&uacute;mero de Tarjeta:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noDocument"/>
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Tarjeta:</label><br/>
                                    <select ng-options="card as card for card in vm.creditCardList"
                                            ng-model="vm.payment.cardBrand" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label>No. Lote:</label><br/>
                                    <input type="text" onkeypress="return ((event.which >= 48 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                                           ng-model="vm.payment.numeroLote" class="form-control" maxlength="5">
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Detalle:</label><br/>
                                    <select ng-options="deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                            ng-model="vm.payment.detail" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Monto a Abonar:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.valorAbono" placeholder="{{vm.creditValue}}"/>
                                </div>
                            </div>
                            <div class="row" ng-show="vm.payment.modePayment === 'DEP'">
                                <div class="form-group col-md-12" ng-show="vm.ctaCtableBankList !== undefined">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>N&uacute;mero de Cuenta</th>
                                                <th>Nombre del Banco</th>
                                                <th>Tipo de Cuenta</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-show="vm.ctaCtableBankList == 0">
                                                <td colspan="2">
                                                    No hay Cuentas Contables de Bancos Ingresadas
                                                </td>
                                            </tr>
                                            <tr dir-paginate = "cuenta in vm.ctaCtableBankList | orderBy:'description' | filter:searchTextTaxes | itemsPerPage: 3" pagination-id = "taxesPagination">
                                                <td>{{cuenta.code}}</td>
                                                <td>{{cuenta.description}}</td>
                                                <td>{{cuenta.accountType}}</td>
                                                <td>
                                                    <button type = "button" title = "Seleccionar" class = "btn btn-primary btn-sm"
                                                            ng-click = "vm.selectCtaCtableBank(cuenta)">
                                                            <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <dir-pagination-controls pagination-id = "taxesPagination"></dir-pagination-controls>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Banco:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.bankName"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>N&uacute;mero de Depósito:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noDocument"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>N&uacute;mero de Cuenta:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noAccount"/>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Detalle:</label><br/>
                                    <select ng-options="deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                            ng-model="vm.payment.detail" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6" ng-show="vm.ctaCtableBankList === undefined">
                                    <label>Monto a Abonar:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.valorAbono" placeholder="{{vm.creditValue}}"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" ng-show="vm.payment.typePayment === 'NTC'">
                        <div class="form-group col-md-12">
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label>N&uacute;mero de Nota de Cr&eacute;dito:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.noDocument" maxlength="17"/>
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Detalle:</label><br/>
                                    <select ng-options="deta.name as deta.code for deta in [{code: 'ABONO POR NOTA DE CREDITO' ,name:'ABONO POR NOTA DE CREDITO'}]"
                                            ng-model="vm.payment.detail" class="form-control">
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Monto de la Nota de Cr&eacute;dito:</label><br/>
                                    <input type="text" class="form-control" ng-model="vm.payment.valorNotac" placeholder="{{vm.creditValue}}"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" title = "Aceptar" class="btn btn-success btn-sm" 
                            ng-disabled = "vm.payment.valorAbono == 0 || vm.payment.valorAbono == '' || vm.payment.valorAbono == null"
                            ng-click="vm.pAbono(vm.payment)" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-thumbs-up" aria-hidden = "true"></span>
                    </button>
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm" ng-click="vm.cancel()" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!--SECCIÓN DE PAGOS MULTIPLES DE FACTURAS DE VENTA-->
    <div class="table-responsive" ng-show="vm.multipleCobroSelected !== undefined">
        <div class = "panel panel-primary">
            <div class = "panel-heading">
                <h4 class = "modal-title">Pago Multiple de Facturas</h4>
            </div>
            <div class = "panel-body">
                <div class = "row">
                    <div class = "form-group col-md-6">
                        <label>Nombre del Cliente:</label><br/>
                        <b>{{vm.clientName}}</b>
                    </div>
                    <div class = "form-group col-md-6">
                        <label>Identificaci&oacute;n del Cliente:</label><br/>
                        <b>{{vm.clientIdentification}}</b><br/>
                    </div>
                </div>
                <div class = "row">
                    <div class = "form-group col-md-6">
                        <label>Seleccione el Tipo de Abono:</label><br/>
                        <select ng-options = "item.code as item.name for item in [{code:'PAC', name:'PAGO CORRIENTE'}]"
                                ng-model = "vm.typePayment" class = "form-control">
                        </select>
                    </div>
                    <div class = "form-group col-md-6" ng-show = "vm.typePayment === 'PAC'">
                        <label>Seleccione Modalidad de Pago:</label><br/>
                        <label class = "radio-inline"><input type="radio" ng-model = "vm.modePayment" 
                               value = "CHQ" name = "cheque">Cheque</label>
                        <label class = "radio-inline"><input type="radio" ng-model = "vm.modePayment" 
                                value = "TRF" name = "transferencia">Transferencia</label>
                        <label class = "radio-inline"><input type="radio" ng-model="vm.modePayment" 
                               value = "DEP" name = "deposito">Depósito Bancario</label>
                    </div>
                </div>
                <div class = "row">
                    <div class = "form-group col-md-6" ng-show = "vm.typePayment === 'PAC'">
                        <label>Fecha de Pago: </label>
                        <div class = "input-group date" id="pickerDateOfMultiplePayment">
                            <input type = "text" class="form-control input-group-addon"/>
                            <span class = "input-group-addon"><span class = "glyphicon glyphicon-calendar"/></span>
                        </div>
                        <script>
                            $('#pickerDateOfMultiplePayment').datetimepicker({format: "DD/MM/YY",});
                        </script>
                    </div>
                    <div class = "form-group col-md-12">
                        <div class = "row" ng-show = "vm.modePayment === 'CHQ'">
                            <div class="form-group col-md-12" ng-show="vm.ctaCtableBankList !== undefined">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>N&uacute;mero de Cuenta</th>
                                            <th>Nombre del Banco</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-show="vm.ctaCtableBankList == 0">
                                            <td colspan="2">
                                                No hay Cuentas Contables de Bancos Ingresadas
                                            </td>
                                        </tr>
                                        <tr dir-paginate = "cuenta in vm.ctaCtableBankList | orderBy:'description' | filter:searchTextTaxes | itemsPerPage: 3" pagination-id = "taxesPagination">
                                            <td>{{cuenta.code}}</td>
                                            <td>{{cuenta.description}}</td>
                                            <td>
                                                <button type = "button" title = "Seleccionar" class = "btn btn-primary btn-sm"
                                                        ng-click = "vm.selectCtaCtableBank(cuenta)">
                                                        <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <dir-pagination-controls pagination-id = "taxesPagination"></dir-pagination-controls>
                            </div>
                            <div class = "form-group col-md-6">
                                <label>Banco:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.bankName"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>N&uacute;mero de Cheque:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.noDocument"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>Monto del Cheque:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.valorDocumento"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>N&uacute;mero de Cuenta:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.noAccount"/>
                            </div>
                            <div class = "form-group col-md-6">
                                <label>Detalle:</label><br/>
                                <select ng-options = "deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                        ng-model = "vm.details" class = "form-control">
                                </select>
                            </div>
                            <div class = "form-group col-md-3">
                                <br/>
                                <button type = "button" title = "Buscar Facturas Pendientes" class = "btn btn-primary btn-sm"
                                        ng-click = "vm.findBills()" data-toggle = "modal" data-target = "#modalFindBills">
                                        Facturas Pendientes
                                </button>
                            </div>
                        </div>
                        <div class = "row" ng-show = "vm.modePayment === 'TRF'">
                            <div class="form-group col-md-12" ng-show="vm.ctaCtableBankList !== undefined">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>N&uacute;mero de Cuenta</th>
                                            <th>Nombre del Banco</th>
                                            <th>Tipo de Cuenta</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-show="vm.ctaCtableBankList == 0">
                                            <td colspan="2">
                                                No hay Cuentas Contables de Bancos Ingresadas
                                            </td>
                                        </tr>
                                        <tr dir-paginate = "cuenta in vm.ctaCtableBankList | orderBy:'description' | filter:searchTextTaxes | itemsPerPage: 3" pagination-id = "taxesPagination">
                                            <td>{{cuenta.code}}</td>
                                            <td>{{cuenta.description}}</td>
                                            <td>{{cuenta.accountType}}</td>
                                            <td>
                                                <button type = "button" title = "Seleccionar" class = "btn btn-primary btn-sm"
                                                        ng-click = "vm.selectCtaCtableBank(cuenta)">
                                                        <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <dir-pagination-controls pagination-id = "taxesPagination"></dir-pagination-controls>
                            </div>
                            <div class = "form-group col-md-6">
                                <label>Banco:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.bankName"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>N&uacute;mero de Transferencia:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.noDocument"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>Monto de la Transferencia:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.valorDocumento"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>N&uacute;mero de Cuenta:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.noAccount"/>
                            </div>
                            <div class = "form-group col-md-6">
                                <label>Detalle:</label><br/>
                                <select ng-options = "deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                        ng-model = "vm.details" class = "form-control">
                                </select>
                            </div>
                            <div class = "form-group col-md-3">
                                <br/>
                                <button type = "button" title = "Buscar Facturas Pendientes" class = "btn btn-primary btn-sm"
                                        ng-click = "vm.findBills()" data-toggle = "modal" data-target = "#modalFindBills">
                                        Facturas Pendientes
                                </button>
                            </div>
                        </div>
                        <div class = "row" ng-show="vm.modePayment === 'DEP'">
                            <div class="form-group col-md-12" ng-show="vm.ctaCtableBankList !== undefined">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>N&uacute;mero de Cuenta</th>
                                            <th>Nombre del Banco</th>
                                            <th>Tipo de Cuenta</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-show="vm.ctaCtableBankList == 0">
                                            <td colspan="2">
                                                No hay Cuentas Contables de Bancos Ingresadas
                                            </td>
                                        </tr>
                                        <tr dir-paginate = "cuenta in vm.ctaCtableBankList | orderBy:'description' | filter:searchTextTaxes | itemsPerPage: 3" pagination-id = "taxesPagination">
                                            <td>{{cuenta.code}}</td>
                                            <td>{{cuenta.description}}</td>
                                            <td>{{cuenta.accountType}}</td>
                                            <td>
                                                <button type = "button" title = "Seleccionar" class = "btn btn-primary btn-sm"
                                                        ng-click = "vm.selectCtaCtableBank(cuenta)">
                                                        <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <dir-pagination-controls pagination-id = "taxesPagination"></dir-pagination-controls>
                            </div>
                            <div class = "form-group col-md-6">
                                <label>Banco:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.bankName"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>N&uacute;mero de Dep&oacute;sito:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.noDocument"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>Monto del Dep&oacute;sito:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.valorDocumento"/>
                            </div>
                            <div class = "form-group col-md-3">
                                <label>N&uacute;mero de Cuenta:</label><br/>
                                <input type = "text" class = "form-control" ng-model = "vm.noAccount"/>
                            </div>
                            <div class = "form-group col-md-6">
                                <label>Detalle:</label><br/>
                                <select ng-options = "deta.name as deta.code for deta in [{code: 'ABONO PARCIAL DE CUOTA' ,name:'ABONO PARCIAL DE CUOTA'}, {code: 'ABONO COMPLEMENTARIO DE CUOTA', name:'ABONO COMPLEMENTARIO DE CUOTA'}, {code: 'PAGO TOTAL DE CUOTA', name:'PAGO TOTAL DE CUOTA'}]"
                                        ng-model = "vm.details" class = "form-control">
                                </select>
                            </div>
                            <div class = "form-group col-md-3">
                                <br/>
                                <button type = "button" title = "Buscar Facturas Pendientes" class = "btn btn-primary btn-sm"
                                        ng-click = "vm.findBills()" data-toggle = "modal" data-target = "#modalFindBills">
                                        Facturas Pendientes
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class = "row">
                    <div class="form-group col-md-12">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>No. Factura</th>
                                    <th>Total</th>
                                    <th>Pendiente</th>
                                    <th>Abono Realizado</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-show="vm.itemsMultiplePayments == 0">
                                    <td colspan="4">
                                        No hay Facturas de Compra Ingresadas
                                    </td>
                                </tr>
                                <tr ng-repeat="mp in vm.itemsMultiplePayments">
                                    <td>{{mp.bill_number}}</td>
                                    <td>{{mp.bill_total.toFixed(2)}}</td>
                                    <td>{{mp.bill_pending.toFixed(2)}}</td>
                                    <td>{{mp.bill_abono.toFixed(2)}}</td>
                                    <td>
                                        <button type = "button" title = "Eliminar Abono" class = "btn btn-primary btn-sm" 
                                                ng-click = "vm.eliminaAbono($index)">
                                                <span class = "glyphicon glyphicon-trash" aria-hidden = "true"></span>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><b>SALDO: {{vm.getTotalMultiAbonos()}}</b></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class = "panel-footer">
                <button type = "button" title = "Aceptar" class = "btn btn-success btn-sm" ng-click = "vm.pagoMultiAbonoBills()"
                        ng-disabled ="vm.getTotalMultiAbonos() != vm.valorDocumento">
                        <span class = "glyphicon glyphicon-thumbs-up" aria-hidden = "true"></span>
                </button>
                <button type = "button" title = "Salir" class = "btn btn-primary btn-sm" ng-click = "vm.cancel()">
                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                </button>
            </div>        
        </div>
    </div>

    <div id = "modalFindBills" class="modal fade" role="dialog">
        <div class = "modal-dialog">
            <div class = "modal-content">
                <div class = "modal-header">
                    <div>
                        <b>Facturas Pertenecientes a: {{vm.clientName}}</b>
                    </div>
                </div>
                <div class = "modal-body">
                    <div class ="row">
                        <div class = "col-md-12" ng-if = "vm.creditsMultiBillsList === undefined && vm.creditsBillsSelected === undefined">
                            <table class = "table table-striped">
                                <thead>
                                    <tr>
                                        <th>No. Factura</th>
                                        <th>Fecha</th>
                                        <th>Total</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-show = "vm.billMultipleList == 0">
                                        <td colspan = "4">
                                            El Cliente <b>No Presenta</b> Facturas Pendientes...
                                        </td>
                                    </tr>
                                    <tr ng-repeat = "bills in vm.billMultipleList">
                                        <td>{{bills.stringSeq}}</td>
                                        <td>{{bills.dateCreated | date : "dd/MM/yyyy"}}</td>
                                        <td>{{bills.total.toFixed(2)}}</td>
                                        <td>
                                            <button type = "button" title = "Consultar Créditos Pendientes" class = "btn btn-primary btn-sm" 
                                                    ng-click = "vm.creditsMultiByBills(bills)">
                                                    <span class = "glyphicon glyphicon-ok" aria-hidden = "true"></span>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div>
                                <button type = "button" title = "Salir" class = "btn btn-primary btn-sm" data-dismiss = "modal">
                                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                                </button>
                            </div>
                        </div>
                        <div class = "col-md-12" ng-if = "vm.creditsMultiBillsList !== undefined">
                            <table class = "table table-striped">
                                <thead>
                                    <tr>
                                        <th>Fecha Limite</th>
                                        <th>N&uacute;mero de Pagos</th>
                                        <th>Saldo por Cancelar</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-show = "vm.creditsMultiBillsList == 0">
                                        <td colspan = "4">
                                            La Factura <b>No Presenta</b> Cobros Pendientes por Cancelar...
                                        </td>
                                    </tr>
                                    <tr ng-repeat = "credits in vm.creditsMultiBillsList | orderBy : 'payNumber' : true">
                                        <td>{{credits.fecha | date : "dd/MM/yyyy"}}</td>
                                        <td>{{credits.payNumber}}</td>
                                        <td>{{credits.valor.toFixed(2)}}</td>
                                        <td>
                                            <button type = "button" title = "Seleccionar Factura" class = "btn btn-primary btn-sm" ng-click = "vm.multipleAbonoBills(credits)">
                                                    <span class = "glyphicon glyphicon-ok" aria-hidden = "true"></span>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div>
                                <button type = "button" title = "Anterior" class = "btn btn-primary btn-sm" ng-click = "vm.creditsMultiBillsList = undefined">
                                        <span class = "glyphicon glyphicon-arrow-left" aria-hidden = "true"></span>
                                </button>
                                <button type = "button" title = "Salir" class = "btn btn-primary btn-sm" data-dismiss = "modal">
                                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                                </button>
                            </div>
                        </div>
                        <div class = "col-md-12" ng-if = "vm.creditsBillsSelected !== undefined">
                            <div>
                                <div class="form-group col-md-6">
                                    <label>Factura Nro:</label><br/>
                                    {{vm.billNumber}}
                                </div>
                                <div class="form-group col-md-6">
                                    <label>Valor Abono:</label><br/>
                                    <input type = "text" class = "form-control" ng-model = "vm.valorAbono"/>
                                </div>
                            </div>
                            <div>
                                <button type = "button" title = "Aceptar" class = "btn btn-success btn-sm" ng-click = "vm.aceptaAbono()">
                                        <span class = "glyphicon glyphicon-thumbs-up" aria-hidden = "true"></span>
                                </button>
                                <button type = "button" title = "Salir" class = "btn btn-primary btn-sm" data-dismiss = "modal">
                                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--CONSULTA DE COBROS REALIZADOS POR CLIENTE-->
    <div class="table-responsive" ng-show="vm.paymentList !== undefined">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Listado de Cobros de Facturas Pertenecientes a: {{vm.clientName}}</b>
            </div>
            <div class="panel-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>N&uacute;mero Factura</th>
                            <th>Fecha</th>
                            <th>Detalle de Cobro</th>
                            <th>Total</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-show="vm.paymentList == 0">
                            <td colspan="4">
                                El Cliente <b>No Presenta</b> Facturas con Cobros realizados...
                            </td>
                        </tr>
                        <tr ng-repeat="payment in vm.paymentList">
                            <td>{{payment.documentNumber}}</td>
                            <td>{{payment.datePayment | date : "dd/MM/yyyy"}}</td>
                            <td>{{payment.detail}}</td>
                            <td>{{payment.valorAbono.toFixed(2)}}</td>
                            <td>
                                <button type="button" title = "Anular Cobro de Factura" class="btn btn-warning btn-sm" 
                                        ng-click="vm.deactivatePayment = payment" data-toggle="modal" data-target="#modalAnularPayment">
                                        <span class = "glyphicon glyphicon-warning-sign" aria-hidden = "true"></span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="panel-footer">
                <button type="button" title = "Salir" class="btn btn-primary btn-sm" ng-click="vm.cancel()">
                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                </button>
            </div>
        </div>
    </div>

    <!--ANULAR COBRO DE FACTURA-->
    <div id="modalAnularPayment" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 class="modal-title">¡¡¡Advertencia!!!</h3>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12" >
                            <p>¿Est&aacute; seguro que desea Anular el Cobro de la Factura <b>No. {{vm.deactivatePayment.documentNumber}}</b>?</p>
                            <p>Recuerde que el Cobro de Factura Anulada <b>NO puede ser Recuperado</b>.</p>
                        </div>
                        <br/>
                        <div class="col-md-12" >
                            <p>Le recordamos que debe dirigirse al módulo de <b>Contabilidad</b> para proceder a anular</p>
                            <p>el Comprobante de Ingreso en la opci&oacute;n <b>"Anular Comprobante de Ingreso"</b>,</p>
                            <p>una vez anulado este Cobro.</p>   
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" title="Anular Cobro de Factura" class="btn btn-danger btn-sm" ng-click="vm.paymentDeactivate()" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-screenshot" aria-hidden = "true"></span>
                    </button>
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!--RETENCIONES DE FACTURAS DE CLIENTES-->
    <div class="table-responsive" ng-show="vm.retentionClient !== undefined && !vm.retentionClientCreated">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Retenci&oacute;n de Factura No. {{vm.billNumber}}</b>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Fecha: </label>
                        <div class="input-group date" id="pickerDateToday">
                            <input type="text" class="form-control input-group-addon"/>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"/></span>
                        </div>
                        <script>
                            $('#pickerDateToday').datetimepicker({format: "DD/MM/YY",});
                        </script>
                    </div>
                    <div class="form-group col-md-6">
                        <label>Tipo de documento: </label>
                        <select ng-options="typeDoc.code as typeDoc.name for typeDoc in vm.documentType  | orderBy:'name'  track by typeDoc.code" ng-model="vm.docType"
                                class="form-control">
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-4">
                        <label>N&uacute;mero de Retenci&oacute;n:</label><br>
                        <input type="text" ng-model="vm.retentionClient.numero"
                               class="form-control" maxlength="17">
                    </div>
                    <div class="form-group col-md-4">
                        <label>Fecha de la Retenci&oacute;n: </label>
                        <div class="input-group date" id="pickerDateRetention">
                            <input type="text" class="form-control input-group-addon" ng-model="vm.retentionClient.ejercicio"/>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"/></span>
                        </div>
                        <script>
                            var defaultDate = new Date();
                            $('#pickerDateRetention').datetimepicker({format: "DD/MM/YY",});
                        </script>
                    </div>
                    <div class="form-group col-md-4">
                        <label>Tipo de Impuesto: </label><br/>
                        <label class="radio-inline"><input type="radio" ng-model="vm.retentionClient.typeRetention" value="1" name="tipo"
                               ng-change="vm.getPercentageTable()">Fuente</label>
                        <label class="radio-inline"><input type="radio" ng-model="vm.retentionClient.typeRetention" value="2" name="tipo"
                               ng-change="vm.getPercentageTable()">IVA</label>
                    </div>
                </div>
                <div class="row" ng-show="vm.tablePercentage !== undefined">
                    <div class="form-group col-md-12">
                        <input ng-model="searchTextPercentage" class="form-control" placeholder="Buscar">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>C&oacute;digo</th>
                                    <th>Descripci&oacute;n</th>
                                    <th>%</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-show="vm.tablePercentage == 0">
                                    <td colspan="2">
                                        No hay Fuente Seleccionada
                                    </td>
                                </tr>
                                <tr dir-paginate="p in vm.tablePercentage | filter:searchTextPercentage | itemsPerPage: 5" pagination-id="clientPagination">
                                    <td>{{p.codigo}}</td>
                                    <td>{{p.name}}</td>
                                    <td>{{p.percentage}}</td>
                                    <td>
                                        <button type="button" title = "Seleccionar" class="btn btn-primary btn-sm"
                                                ng-click="vm.selecPercentage(p)" data-toggle="modal" data-target="#modalBImponible">
                                                <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <dir-pagination-controls pagination-id="clientPagination"></dir-pagination-controls>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>IMPUESTO TIPO</th>
                                    <th>CODIGO</th>
                                    <th>BASE IMPONIBLE</th>
                                    <th>RETENCIONES %</th>
                                    <th>VALOR $</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-show="vm.retentionClient.items == 0">
                                    <td colspan="5">
                                        No hay Fuente Seleccionada
                                    </td>
                                </tr>
                                <tr ng-repeat="i in vm.retentionClient.items" >
                                    <td>
                                        <span ng-if="i.codigo === 1">RETENCION EN LA FUENTE</span>
                                        <span ng-if="i.codigo === 2">RETENCION EN EL IVA</span>
                                    </td>
                                    <td>{{i.codigo_porcentaje}}</td>
                                    <td>{{i.base_imponible.toFixed(2)}}</td>
                                    <td>{{i.porcentaje}}</td>
                                    <td>{{i.valor_retenido.toFixed(2)}}</td>
                                    <td>
                                        <button type="button" title = "Editar" class="btn btn-primary btn-sm"
                                                ng-click="vm.editItem($index)" data-toggle="modal" data-target="#modalBImponible">
                                                <span class = "glyphicon glyphicon-pencil" aria-hidden = "true"></span>
                                        </button>
                                        <button type="button" title = "Eliminar" class="btn btn-primary btn-sm"
                                                ng-click="vm.deleteItem($index)">
                                                <span class = "glyphicon glyphicon-trash" aria-hidden = "true"></span>
                                        </button>
                                    </td>  
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><b>TOTAL</b></td>
                                    <td>{{vm.getTotalRetencionesClient()}}</td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <button type="button" title = "Previsualizar Retención" class="btn btn-primary btn-sm" ng-click="vm.previewRetentionClient()" 
                                data-toggle="modal" data-target="#modalPreview" 
                                ng-disabled="vm.retentionClient.items == 0">
                                <span class = "glyphicon glyphicon-blackboard" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Crear Retención" class="btn btn-success btn-sm"
                                ng-click="vm.saveRetentionClient(vm.retentionClient)" ng-disabled="vm.retentionClient.items == 0">
                                <span class = "glyphicon glyphicon-saved" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Salir" class="btn btn-primary btn-sm"
                                ng-click="vm.cancel()">
                                <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="table-responsive" ng-show="vm.retentionClientCreated">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h4>Comprobante</h4>
                <b>Retención de Factura No. {{vm.billNumber}}</b>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="form-group col-md-12 ">
                        <table width="100%">
                            <tr>
                            <td>
                                <div style="padding:0px 20px;">
                                    <b>NOMBRE DEL CLIENTE: {{vm.clientName}}</b><br/>
                                    <b>IDENTIFICACIÓN: {{vm.clientIdentification}}</b><br/><br/>
                                    <b>Nro. DE RETENCIÓN: {{vm.retentionClient.retentionNumber}}</b><br/>
                                    <b>FECHA: {{vm.retentionClient.documentDate | date : "dd-MM-yyyy"}}</b><br/>
                                    <b>EJERCICIO FISCAL: {{vm.retentionClient.ejercicioFiscal}}</b><br/>
                                </div>
                            </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12 ">
                        <table width="100%" border="1">
                            <tr>
                                <td><b>EJERCICIO FISCAL </b></td>
                                <td><b>TIPO IMPUESTO </b></td>
                                <td><b>CODIGO </b></td>
                                <td><b>BASE IMPONIBLE </b></td>
                                <td><b>RETENCIONES % </b></td>
                                <td><b>VALOR </b></td>
                            </tr>
                            <tr ng-repeat="detail in vm.retentionClient.detailRetentionClient">
                                <td>{{vm.retentionClient.ejercicioFiscal}}</td>
                                <td>{{detail.taxType}}</td>
                                <td>{{detail.code}}</td>
                                <td>{{detail.baseImponible.toFixed(2)}}</td>
                                <td>{{detail.percentage}}</td>
                                <td>{{detail.total.toFixed(2)}}</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><b>TOTAL</b></td>
                                <td>{{vm.totalRetention.toFixed(2)}}</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm"
                            ng-click="vm.cancel()">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="modalPreview" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.impuesto=undefined">&times;</button>
                    <h4>Retención de Factura No. {{vm.billNumber}}</h4>
                </div>
                <div class="panel panel-primary">
                    <div class="panel-body">
                        <div class="row">
                            <div class="form-group col-md-12">
                                <table width="100%">
                                    <tr>
                                        <td>
                                            <div style="padding:0px 20px;">
                                                <b>NOMBRE DEL CLIENTE: {{vm.clientName}}</b><br/>
                                                <b>IDENTIFICACIÓN: {{vm.clientIdentification}}</b><br/><br/>
                                                <b>Nro. DE RETENCIÓN: {{vm.retentionClient.retentionNumber}}</b><br/>
                                                <b>FECHA: {{vm.retentionClient.documentDate | date : "dd-MM-yyyy"}}</b><br/>
                                                <b>EJERCICIO FISCAL: {{vm.retentionClient.ejercicio}}</b><br/>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-md-12 ">
                                <table width="100%" border="1">
                                    <tr>
                                        <td><b>EJERCICIO FISCAL </b></td>
                                        <td><b>TIPO IMPUESTO </b></td>
                                        <td><b>CODIGO </b></td>
                                        <td><b>BASE IMPONIBLE </b></td>
                                        <td><b>RETENCIONES % </b></td>
                                        <td><b>VALOR </b></td>
                                    </tr>
                                    <tr ng-repeat="detail in vm.retentionClient.detailRetentionClient">
                                        <td>{{vm.retentionClient.ejercicioFiscal}}</td>
                                        <td>{{detail.taxType}}</td>
                                        <td>{{detail.code}}</td>
                                        <td>{{detail.baseImponible.toFixed(2)}}</td>
                                        <td>{{detail.percentage}}</td>
                                        <td>{{detail.total.toFixed(2)}}</td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td><b>TOTAL</b></td>
                                        <td>{{vm.totalRetention.toFixed(2)}}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="modalBImponible" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.impuesto=undefined">&times;</button>
                    <h4 class="modal-title">Base Imponible</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3" ng-if="vm.item.codigo === 1">
                            <b>Retenci&oacute;n en la Fuente</b>
                        </div>
                        <div class="col-md-3" ng-if="vm.item.codigo === 2">
                            <b>Retenci&oacute;n del IVA</b>
                        </div>
                        <div class="col-md-3">
                            C&oacute;digo: <b>{{vm.item.codigo_porcentaje}}</b>
                        </div>
                        <div class="col-md-3">
                            Retenci&oacute;n %: <b>{{vm.item.porcentaje}}</b>
                        </div>
                        <div class="col-md-3" ng-if="vm.item.codigo === 1">
                            <label>Valor</label>
                            <input type="text" onkeypress="return ((event.which >= 46 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                                   class="form-control" maxlength="9" ng-model="vm.item.base_imponible" placeholder="{{vm.creditValueSubtotal}}"/>
                        </div>
                        <div class="col-md-3" ng-if="vm.item.codigo === 2">
                            <label>Valor</label>
                            <input type="text" onkeypress="return ((event.which >= 46 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                                   class="form-control" maxlength="9" ng-model="vm.item.base_imponible" placeholder="{{vm.creditValueIva}}"/>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" title = "Aceptar" class="btn btn-success btn-sm" data-dismiss="modal" ng-click="vm.addItem()">
                            <span class = "glyphicon glyphicon-thumbs-up" aria-hidden = "true"></span>
                    </button>
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm"  data-dismiss="modal"
                            ng-click="vm.item = undefined; vm.indexEdit = undefined;">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!--FIN DE SECCIÓN DE RETENCIONES-->
</div>