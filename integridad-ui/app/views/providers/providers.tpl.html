<div style="width: 100%;height: 100%;top: 0px;left: 0px;position: fixed;display: block; z-index: 99; background: rgba(255, 255, 255, 0.3)" ng-show="vm.loading">
    <div style="position: absolute;top: 15%;z-index: 100; width: 100%; text-align: center;">
        <div class="sk-circle">
            <div class="sk-circle1 sk-child"></div>
            <div class="sk-circle2 sk-child"></div>
            <div class="sk-circle3 sk-child"></div>
            <div class="sk-circle4 sk-child"></div>
            <div class="sk-circle5 sk-child"></div>
            <div class="sk-circle6 sk-child"></div>
            <div class="sk-circle7 sk-child"></div>
            <div class="sk-circle8 sk-child"></div>
            <div class="sk-circle9 sk-child"></div>
            <div class="sk-circle10 sk-child"></div>
            <div class="sk-circle11 sk-child"></div>
            <div class="sk-circle12 sk-child"></div>
        </div>
    </div>
</div>

<div class="form-group col-md-12">
    <div class="header">
        <h4>
            <b>Compras</b> 
            <b ng-show="vm.purchasesOption === 'PROV'"> - Proveedores</b>
            <b ng-show="vm.purchasesOption === 'RETN'"> - Retenciones</b>
            <b ng-show="vm.purchasesOption === 'REPT'"> - Reportes</b>
        </h4>
    </div>

    <div class="row" ng-show="vm.error !== undefined">
        <div class="form-group col-md-12">
            <div class="alert alert-danger">{{vm.error}}</div>
        </div>
    </div>
    <div class="row" ng-show="vm.success !== undefined">
        <div class="form-group col-md-12">
            <div class="alert alert-success">{{vm.success}}</div>
        </div>
    </div>

    <div class="table-responsive" ng-show="vm.provider === undefined && vm.retention === undefined && vm.debtsToPay === undefined && vm.retentionList === undefined && vm.reportStatementProviderSelected === undefined">
        <div class="row">
            <div class="form-group col-md-10">
                <input id="inputPr0" ng-model="searchText" class="form-control" placeholder="Buscar">
            </div>
            <div class="form-group col-md-1">
                <button type="button" title = "Agregar Nuevo Proveedor" class="btn btn-primary" ng-click="vm.providerCreate()">
                        <span class = "glyphicon glyphicon-user" aria-hidden = "true"></span>
                </button>
            </div>
        </div>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>C&oacute;digo</th>
                    <th>Nombre Comercial</th>
                    <th>Raz&oacute;n Social</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-show="vm.providerList == 0">
                    <td colspan="4">
                        No hay proveedores ingresados
                    </td>
                </tr>
                <tr ng-repeat="providerEdit in vm.providerList | orderBy:'name' | filter:searchText">
                    <td>{{providerEdit.codeIntegridad}}</td>
                    <td>{{providerEdit.name}}</td>
                    <td>{{providerEdit.razonSocial}}</td>
                    <td>
                        <button type="button" title = "Editar Proveedor" class="btn btn-primary btn-sm" ng-click="vm.editProvider(providerEdit)" ng-show="vm.purchasesOption === 'PROV'">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </button>
                        <button type="button" title = "Eliminar Proveedor" class="btn btn-primary btn-sm" ng-click="vm.provider=providerEdit"
                                data-toggle="modal" data-target="#modalEliminar" ng-show="vm.purchasesOption === 'PROV'">
                                <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                        </button>
                        <button type="button" title = "Nueva RetenciÃ³n" class="btn btn-success btn-sm" ng-click="vm.createRetention(providerEdit)"
                                ng-if="vm.subOnlineActive" ng-show="vm.purchasesOption === 'RETN'">
                                <span class = "glyphicon glyphicon-tasks" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Consultar Retenciones" class="btn btn-primary btn-sm" ng-click="vm.providerConsultRetention(providerEdit)"
                                ng-if="vm.subOnlineActive" ng-show="vm.purchasesOption === 'REPT'">
                                <span class = "glyphicon glyphicon-search" aria-hidden = "true"></span>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="row">
            <div class="form-group col-md-12">
                <button type="button" title="Volver a Inicio" class="btn btn-danger btn-sm"
                        ng-click="vm.exit()">
                        <span class="glyphicon glyphicon-log-out" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="panel panel-primary" ng-show="vm.reportStatementProviderSelected !== undefined">
        <div class="panel-heading">
            <b>Reporte Estado de Cuenta del Proveedor: {{vm.providerName}}</b>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="form-group col-md-6 ">
                    <label>FECHA FIN: </label>
                    <div class="input-group date" id="pickerStatePDateTwo">
                        <input type="text" class="form-control input-group-addon"/>
                        <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"/></span>
                    </div>
                    <script>
                        $('#pickerStatePDateTwo').datetimepicker({
                            format: "DD/MM/YY",
                        });
                    </script>
                </div>
            </div>
        </div>
        <div class="panel-footer">
            <div class="row">
                <div class="form-group col-md-10">
                    <br/>
                    <button type="button" title="Seleccione Fecha Fin" class="btn btn-primary btn-sm"
                            ng-click="vm.getStatementProviderReport()">
                            Edo. Cuenta
                    </button>
                </div>
                <div class="form-group col-md-2">
                    <p><b>Exportar</b></p>
                    <button type="button" class="btn btn-primary btn-sm"
                            ng-click="vm.exportExcel()" ng-disabled="vm.reportList === undefined || vm.reportList.length === 0">
                            Excel
                    </button>
                </div>
            </div>
            <div ng-show="vm.reportList.length === 0">
                <br/>
                <b>No hay registros que coincidan con la b&uacute;squeda</b>
            </div>
        </div>

        <!--Reporte de Estado de Cuenta-->
        <div class="table-responsive" ng-if="vm.isProductReportList === '1'">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>RUC</th>
                        <th>Proveedor</th>
                        <th>Factura</th>
                        <th>Fecha Compra</th>
                        <th>Fecha Vence</th>
                        <th>Fecha Pago</th>
                        <th>Doc. Intr. Nro:</th>
                        <th>Nro. Retenci&oacute;n</th>
                        <th>Detalle</th>
                        <th>Observaci&oacute;n</th>
                        <th>Modo de Pago</th>
                        <th>Nro. Cheque</th>
                        <th>Venta</th>
                        <th>Abonos</th>
                        <th>Retenciones</th>
                        <th>Saldo Pendiente</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="data in vm.reportList | orderBy:'code'" >
                        <td>{{data.ruc}}</td>
                        <td>{{data.providerName}}</td>
                        <td>{{data.billNumber}}</td>
                        <td>{{data.fechCompra}}</td>
                        <td>{{data.fechVence}}</td>
                        <td>{{data.fechPago}}</td>
                        <td>{{data.debtsSeq}}</td>
                        <td>{{data.retenNumber}}</td>
                        <td>{{data.detalle}}</td>
                        <td>{{data.observacion}}</td>
                        <td>{{data.modePayment}}</td>
                        <td>{{data.numCheque}}</td>
                        <td>{{data.total.toFixed(2)}}</td>
                        <td>{{data.valorAbono.toFixed(2)}}</td>
                        <td>{{data.valorReten.toFixed(2)}}</td>
                        <td>{{data.saldo.toFixed(2)}}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="row">
            </br>
            <div class="form-group col-md-12">
                <button type="button" title="Salir" class="btn btn-danger btn-sm"
                        ng-click="vm.exit()">
                        <span class="glyphicon glyphicon-log-out" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="table-responsive" ng-show="vm.retentionList !== undefined">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Listado de Retenciones Pertenecientes a: {{vm.providerName}}</b>
            </div>
            <div class="panel-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Nro. Retenci&oacute;n</th>
                            <th>Fecha</th>
                            <th>Nro. Factura</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-show="vm.retentionList == 0">
                            <td colspan="4">
                                No hay Retenciones ingresadas para este Proveedor
                            </td>
                        </tr>
                        <tr ng-repeat="retention in vm.retentionList | orderBy:'dateCreated':true | filter:searchText">
                            <td>{{retention.stringSeq}}</td>
                            <td>{{retention.dateCreated | date : "dd/MM/yyyy"}}</td>
                            <td>{{retention.documentNumber}}</td>
                            <td>
                                <button type="button" title="Ver RetenciÃ³n" class="btn btn-primary btn-sm" ng-click="vm.retentionSelected(retention)">
                                        <span class = "glyphicon glyphicon-eye-open" aria-hidden = "true"></span>
                                </button>
                                <button type="button" title="Anular RetenciÃ³n" class="btn btn-warning btn-sm" ng-click="vm.deactivateRetention = retention"
                                        data-toggle="modal" data-target="#modalAnularRetention">
                                        <span class = "glyphicon glyphicon-warning-sign" aria-hidden = "true"></span>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="panel-footer">
                <button type="button" title = "Salir" class="btn btn-primary btn-sm"
                        ng-click="vm.cancel()">
                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="table-responsive" ng-show="vm.provider !== undefined">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Datos del Proveedor</b>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="form-group col-md-4">
                        <label>C&oacute;digo: </label>
                        <input type="text" ng-model="vm.provider.codeIntegridad" class="form-control">
                    </div>
                    <div class="form-group col-md-8">
                        <label>Tipo de proveedor: </label>
                        <select ng-options="tipo as tipo for tipo in vm.providerType" ng-model="vm.provider.providerType"
                                class="form-control">
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Tipo de Identificaci&oacute;n: </label>
                        <select ng-options="item.code as item.name for item in [{code:'CED', name:'CEDULA'}, {code:'RUC', name:'RUC'}, {code:'IEX', name:'IDENTIFICACIÃN EXTERIOR'}]"
                                ng-model="vm.provider.rucType" class="form-control">
                        </select>
                    </div>
                    <div class="form-group col-md-6" ng-show="vm.provider.rucType === 'CED'">
                        <label>C&eacute;dula: </label>
                        <input type="text" onkeypress="return ((event.which >= 48 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                               ng-model="vm.provider.ruc" class="form-control" maxlength="10">
                    </div>
                    <div class="form-group col-md-6" ng-show="vm.provider.rucType === 'RUC'">
                        <label>RUC: </label>
                        <input type="text" onkeypress="return ((event.which >= 48 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                               ng-model="vm.provider.ruc" class="form-control" maxlength="13">
                    </div>
                    <div class="form-group col-md-6" ng-show="vm.provider.rucType === 'IEX'">
                        <label>ID. Exterior: </label>
                        <input type="text" onkeypress="return ((event.which >= 48 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                               ng-model="vm.provider.ruc" class="form-control" maxlength="13">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <label>Nombre Comercial: </label>
                        <input type="text" ng-model="vm.provider.name" class="form-control">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <label>Raz&oacute;n Social: </label>
                        <input type="text" ng-model="vm.provider.razonSocial" class="form-control">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <label>Direcci&oacute;n: </label>
                        <input type="text" ng-model="vm.provider.address1" class="form-control">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Pa&iacute;s: </label>
                        <input type="text" ng-model="vm.provider.country" class="form-control">
                    </div>
                    <div class="form-group col-md-6">
                        <label>Ciudad: </label>
                        <input type="text" ng-model="vm.provider.city" class="form-control">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Tel&eacute;fono: (incluir c&oacute;digo de provincia ej: 02) </label>
                        <input type="text" onkeypress="return ((event.which >= 48 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                               ng-model="vm.provider.phone" class="form-control" maxlength="9">
                    </div>
                    <div class="form-group col-md-6">
                        <label>Tel&eacute;fono celular: </label>
                        <input type="text" onkeypress="return ((event.which >= 48 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                               ng-model="vm.provider.celPhone" class="form-control" maxlength="10">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Email: </label>
                        <input type="text" ng-model="vm.provider.email" class="form-control">
                    </div>
                    <div class="form-group col-md-6">
                        <label>Contacto: </label>
                        <input type="text" ng-model="vm.provider.contact" class="form-control">
                    </div>
                </div>
            </div>
            <div class="panel-footer">
                <button type="button" title = "Guardar Proveedor" class="btn btn-success btn-sm" ng-click="vm.register()"
                        ng-disabled="vm.disableSave()">
                        <span class = "glyphicon glyphicon-floppy-save" aria-hidden = "true"></span>
                </button>
                <button type="button" title = "Salir" class="btn btn-primary btn-sm"
                        ng-click="vm.cancel()">
                        <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                </button>
            </div>
        </div>
    </div>

    <!--INICIO DEL MODULO DE RETENCIONES-->
    <div class="table-responsive" ng-show="vm.retention !== undefined && !vm.retentionCreated">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Datos para La Retenci&oacute;n</b>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>C&oacute;digo Proveedor: </label>
                        {{vm.retention.provider.codeIntegridad}}
                    </div>
                    <div class="form-group col-md-6">
                        <label>RUC / CEDULA: </label>
                        {{vm.retention.provider.ruc}}
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Nombre Comercial: </label>
                        {{vm.retention.provider.name}}
                    </div>
                    <div class="form-group col-md-6">
                        <label>Raz&oacute;n Social: </label>
                        {{vm.retention.provider.razonSocial}}
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <label>Direcci&oacute;n: </label>
                        {{vm.retention.provider.address1}}
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>N&uacute;mero de Retenci&oacute;n: </label>
                        <b>{{vm.seqNumber}}</b>
                    </div>

                    <div class="form-group col-md-6">
                        <label>Tipo de documento: </label>
                        <select ng-options="typeDoc.code as typeDoc.name for typeDoc in vm.documentType  | orderBy:'name'  track by typeDoc.code" ng-model="vm.docType"
                                class="form-control">
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label>Fecha: </label>
                        <div class="input-group date" id="pickerBillDateRetention">
                            <input type="text" class="form-control input-group-addon"/>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"/></span>
                        </div>
                        <script>
                            var defaultDate = new Date();
                            $('#pickerBillDateRetention').datetimepicker({format: "DD/MM/YY",});
                        </script>
                    </div>
                    <div class="form-group col-md-6">
                        <label>N&uacute;mero de Documento: </label>
                        <input type="text" ng-model="vm.retention.numero" class="form-control" maxlength="17">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-4">
                        <label>Fecha Documento: </label>
                        <div class="input-group date" id="pickerBillDateDocumentRetention">
                            <input type="text" class="form-control input-group-addon"/>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
                        </div>
                        <script>
                            $('#pickerBillDateDocumentRetention').datetimepicker({
                              format: "DD/MM/YY",
                            });
                        </script>
                    </div>
                    <div class="form-group col-md-4">
                        <label>Tipo de Impuesto: </label><br/>
                        <label class="radio-inline"><input type="radio" ng-model="vm.retention.typeRetention" value="1" name="tipo"
                               ng-change="vm.getPercentageTable()" ng-disabled="vm.retention.numero === undefined">Fuente</label>
                        <label class="radio-inline"><input type="radio" ng-model="vm.retention.typeRetention" value="2" name="tipo"
                               ng-change="vm.getPercentageTable()" ng-disabled="vm.retention.numero === undefined">IVA</label>
                    </div>
                    <div class="form-group col-md-4">
                        <label>Ejercicio Fiscal: </label><br/>
                        <label>{{vm.retention.ejercicio}} </label>
                    </div>
                </div>
                <div class="row" ng-show="vm.tablePercentage !== undefined">
                    <div class="form-group col-md-12">
                        <input ng-model="searchTextPercentage" class="form-control" placeholder="Buscar">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>C&oacute;digo</th>
                                    <th>Descripci&oacute;n</th>
                                    <th>%</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-show="vm.tablePercentage == 0">
                                    <td colspan="2">
                                        No hay Fuente Seleccionada
                                    </td>
                                </tr>
                                <tr dir-paginate="p in vm.tablePercentage | filter:searchTextPercentage | itemsPerPage: 5" pagination-id="clientPagination">
                                    <td>{{p.codigo}}</td>
                                    <td>{{p.fullDescription}}</td>
                                    <td>{{p.percentage}}</td>
                                    <td>
                                        <button type="button" title = "Seleccionar" class="btn btn-primary btn-sm"
                                                ng-click="vm.selecPercentage(p)" data-toggle="modal" data-target="#modalBaseImponible">
                                                <span class = "glyphicon glyphicon-check" aria-hidden = "true"></span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <dir-pagination-controls pagination-id="clientPagination"></dir-pagination-controls>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>IMPUESTO TIPO</th>
                                    <th>CODIGO</th>
                                    <th>BASE IMPONIBLE</th>
                                    <th>RETENCIONES %</th>
                                    <th>VALOR $</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-show="vm.retention.items == 0">
                                    <td colspan="5">
                                        No hay Fuente Seleccionada
                                    </td>
                                </tr>
                                <tr ng-repeat="i in vm.retention.items" >
                                    <td>
                                        <span ng-if="i.codigo === 1">RETENCION EN LA FUENTE</span>
                                        <span ng-if="i.codigo === 2">RETENCION EN EL IVA</span>
                                    </td>
                                    <td>{{ i.codigo_porcentaje }}</td>
                                    <td>{{ i.base_imponible }}</td>
                                    <td>{{ i.porcentaje }}</td>
                                    <td>{{ i.valor_retenido }}</td>
                                    <td>
                                        <button type="button" title = "Editar" class="btn btn-primary btn-sm"
                                                ng-click="vm.editItem($index)" data-toggle="modal" data-target="#modalBaseImponible">
                                                <span class = "glyphicon glyphicon-pencil" aria-hidden = "true"></span>
                                        </button>
                                        <button type="button" title = "Eliminar" class="btn btn-primary btn-sm"
                                                ng-click="vm.deleteItem($index)">
                                                <span class = "glyphicon glyphicon-trash" aria-hidden = "true"></span>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><b>TOTAL</b></td>
                                    <td>{{vm.getTotalRetenciones()}}</td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12">
                        <button type="button" title = "Previsualizar RetenciÃ³n" class="btn btn-primary btn-sm" ng-click="vm.previsualisation()"
                                data-toggle="modal" data-target="#modalPrevisualizacion"
                                ng-disabled="vm.retention.items == 0">
                                <span class = "glyphicon glyphicon-blackboard" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Guardar RetenciÃ³n" class="btn btn-success btn-sm"
                                ng-click="vm.getClaveAcceso()" ng-disabled="vm.retention.items == 0">
                                <span class = "glyphicon glyphicon-saved" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Salir" class="btn btn-primary btn-sm"
                                ng-click="vm.retention = undefined">
                                <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="table-responsive" ng-show="vm.retentionCreated" id="printArea" print-section>
        <div class="panel panel-primary">
            <div class="panel-heading">
                <b>Datos de la Retenci&oacute;n</b>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="form-group col-md-12">
                        <table width="100%">
                            <tr>
                                <td width="50%" align="center"><img src="images/{{vm.userData.subsidiary.userClient.logo}}" ><br></td>
                                <td width="50%" rowspan="2">
                                    <div style="padding:0px 20px;">
                                        <b>RUC: {{vm.userData.subsidiary.userClient.ruc}}</b><br/>
                                        <b>COMPROBANTE DE RETENCION</b><br/>
                                        <b>No: {{vm.retention.stringSeq}}</b><br/>
                                        <b>AUTORIZACION: {{vm.retention.claveDeAcceso}}</b><br/>
                                        <b>FECHA DE EMISIÃN: {{vm.retention.dateCreated | date : "dd-MM-yyyy"}}</b><br/>
                                        <b>FACTURA: {{vm.retention.documentNumber}}</b><br/>
                                        <b>AMBIENTE: {{vm.retention.userIntegridadcashier.subsidiary.userClient.testMode ? 'PRUEBAS' : 'PRODUCCION'}}</b><br/><br/>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td  width="50%" valign="top">
                                    <div style="padding:10px 20px;">
                                        <b>{{vm.userData.subsidiary.userClient.name}}</b><br/></br>
                                        <b>Matriz: {{vm.userData.subsidiary.userClient.address1}}</b><br/>
                                        <b>Establecimiento: {{vm.userData.subsidiary.address1}}</b><br/>
                                        <b>Tel&eacute;fono: {{vm.userData.subsidiary.phone}}</b><br/>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12 ">
                        <table width="100%">
                            <tr>
                                <td width="50%">
                                    <div>
                                        <label>Raz&oacute;n social / Nombres y Apellidos: </label>
                                        {{vm.retention.provider.razonSocial}}
                                    </div>
                                </td>
                                <td width="50%" style=" padding-left: 10px">
                                    <label>Identificaci&oacute;n: </label>
                                    {{vm.retention.provider.ruc}}
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <label>Fecha del Documento: </label>
                                        {{vm.retention.documentDate | date : "dd-MM-yyyy"}}
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div>
                                        <label>Direcci&oacute;n: </label>
                                        {{vm.retention.provider.address1}}
                                    </div>
                                </td>
                                <td style=" padding-left: 10px">
                                    <label>E-mail: </label>
                                    {{vm.retention.provider.email}}
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-12 ">
                        <table width="100%" border="1">
                            <tr>
                                <td><b>EJERCICIO FISCAL </b></td>
                                <td><b>TIPO IMPUESTO </b></td>
                                <td><b>CODIGO </b></td>
                                <td><b>BASE IMPONIBLE </b></td>
                                <td><b>RETENCIONES % </b></td>
                                <td><b>VALOR </b></td>
                            </tr>
                            <tr ng-repeat="detail in vm.retention.detailRetentions">
                                <td>{{vm.retention.ejercicioFiscal}}</td>
                                <td>{{detail.taxType}}</td>
                                <td>{{detail.code}}</td>
                                <td>{{detail.baseImponible}}</td>
                                <td>{{detail.percentage}}</td>
                                <td>{{detail.total}}</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><b>TOTAL</b></td>
                                <td>{{(vm.totalRetention).toFixed(2)}}</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="row" print-remove>
                    <div class="form-group col-md-12">
                        <button print-btn type="button" title = "Imprimir Comprobante" class="btn btn-primary btn-sm"
                                ng-click="vm.cancelRetentionCreated()">
                                <span class = "glyphicon glyphicon-print" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Descargar RetenciÃ³n EpsonTM20" class="btn btn-success btn-sm"
                                ng-click="vm.downloadRetentionTxtTM20('retentionToDownloadEpsonTM20')">
                                <span class = "glyphicon glyphicon-save-file" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Imprimir Ticket-RetenciÃ³n" class="btn btn-danger btn-sm"
                                ng-click="vm.printToCart('printMatrixRetentionId')">
                                <span class = "glyphicon glyphicon-print" aria-hidden = "true"></span>
                        </button>
                        <button type="button" title = "Salir" class="btn btn-primary btn-sm"
                                ng-click="vm.cancelRetentionCreated()">
                                <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="retentionToDownloadEpsonTM20" ng-show='false'>
        <p>------------------------------</p><br>
        <p>COMPROBANTE DE RETENCION</p><br>
        <p>No: {{vm.retention.stringSeq}}</p><br>
        <p>AUTORIZACION:</p><br>
        <p>{{vm.retention.claveDeAcceso}}</p><br>
        <p>FECHA DE EMISIÃN: {{vm.retention.dateCreated | date : "dd-MM-yyyy"}}</p><br>
        <p>FACTURA: {{vm.retention.documentNumber}}</p><br>
        <p>FECHA DOCUMENTO: {{vm.retention.documentDate | date : "dd-MM-yyyy"}}</p><br>
        <p>RAZON SOCIAL: {{vm.retention.provider.razonSocial}}</p><br>
        <p>IDENTIFICACION: {{vm.retention.provider.ruc}}</p><br>
        <p>E. FISC... T. IMP.... COD... B. IMPO... % RET... VALOR</p><br>
        <table width="100%">
            <tr ng-repeat="detail in vm.retention.detailRetentions">
                <td>{{vm.retention.ejercicioFiscal}} {{(detail.taxType).substr(0,19)}} {{detail.code}} &#36;{{detail.baseImponible}} {{detail.percentage}} &#36;{{detail.total}}</td>
            </tr>
        </table><br>
        <b>TOTAL: {{(vm.totalRetention).toFixed(2)}}</b><br/>
        <p>------------------------------</p>
    </div>

    <div id="printMatrixRetentionId" ng-show='false'>
        ------------------------------<br/>
        <b>COMPROBANTE DE RETENCION</b><br/>
        <b>No: {{vm.retention.stringSeq}}</b><br/>
        <b>AUTORIZACION:</b><br/>
        <b>{{vm.retention.claveDeAcceso}}</b><br/>
        <b>FECHA DE EMISIÃN: {{vm.retention.dateCreated | date : "dd-MM-yyyy"}}</b><br/>
        <b>FACTURA: {{vm.retention.documentNumber}}</b><br/>
        <b>FECHA DOCUMENTO: {{vm.retention.documentDate | date : "dd-MM-yyyy"}}</b><br/>

        <b>RAZON SOCIAL: {{vm.retention.provider.razonSocial}}</b><br/>
        <b>IDENTIFICACION: {{vm.retention.provider.ruc}}</b><br/>
        
        <table width="100%">
            <thead>
                <tr>
                    <th>E. FISCAL</th>
                    <th>T. IMP.</th>
                    <th>COD</th>
                    <th>B. IMPON.</th>
                    <th>% RET</th>
                    <th>VALOR</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="detail in vm.retention.detailRetentions">
                    <td>{{vm.retention.ejercicioFiscal}}</td>
                    <td>{{(detail.taxType).substr(0,19)}}</td>
                    <td>{{detail.code}}</td>
                    <td>{{detail.baseImponible}}</td>
                    <td>{{detail.percentage}}</td>
                    <td>{{detail.total}}</td>
                </tr>
            </tbody>
        </table>
        <b>TOTAL: {{(vm.totalRetention).toFixed(2)}}</b><br/>

        ------------------------------------
    </div>

    <div id="modalPrevisualizacion"  class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.impuesto=undefined">&times;</button>
                    <h4 class="modal-title">Retenci&oacute;n</h4>
                </div>
                <div class="panel panel-primary">
                    <div class="panel-body">
                        <div class="row">
                            <div class="form-group col-md-12">
                                <table width="100%">
                                    <tr>
                                        <td width="50%" align="center"><img src="images/{{vm.userData.subsidiary.userClient.logo}}" ><br></td>
                                        <td width="50%" rowspan="2">
                                            <div style="padding:0px 20px;">
                                                <b>RUC: {{vm.userData.subsidiary.userClient.ruc}}</b><br/>
                                                <b>COMPROBANTE DE RETENCION</b><br/><br/>
                                                <b>No: {{vm.retention.stringSeq}}</b><br/>
                                                <b>AUTORIZACION: {{vm.retention.claveDeAcceso}}</b><br/>
                                                <b>FECHA DE EMISIÃN: {{vm.today | date : "dd-MM-yyyy"}}</b><br/>
                                                <b>FACTURA No: {{vm.retention.numero}}</b>
                                                <b>AMBIENTE: {{vm.retention.userIntegridadcashier.subsidiary.userClient.testMode ? 'PRUEBAS' : 'PRODUCCION'}}</b><br/><br/>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td  width="50%" valign="top">
                                            <div style="padding:10px 20px;">
                                                <b>{{vm.userData.subsidiary.userClient.name}}</b><br/></br>
                                                <b>Matriz: {{vm.userData.subsidiary.userClient.address1}}</b><br/>
                                                <b>Establecimiento: {{vm.userData.subsidiary.address1}}</b><br/>
                                                <b>Tel&eacute;fono: {{vm.userData.subsidiary.phone}}</b><br/>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-md-12 ">
                                <table width="100%">
                                    <tr>
                                        <td width="50%">
                                            <div >
                                                <label>Raz&oacute;n social / Nombres y Apellidos: </label>
                                                {{vm.retention.provider.razonSocial}}
                                            </div>
                                        </td>
                                        <td width="50%" style=" padding-left: 10px">
                                            <label>identificaci&oacute;n: </label>
                                            {{vm.retention.provider.ruc}}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div>
                                                <label>Fecha de emisi&oacute;n: </label>
                                                {{vm.today | date : "dd-MM-yyyy"}}
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div>
                                                <label>Direcci&oacute;n: </label>
                                                {{vm.retention.provider.address1}}
                                            </div>
                                        </td>
                                        <td style=" padding-left: 10px">
                                            <label>E-mail: </label>
                                            {{vm.retention.provider.email}}
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-md-12 ">
                                <table width="100%" border="1">
                                    <tr>
                                        <td><b>EJERCICIO FISCAL </b></td>
                                        <td><b>TIPO IMPUESTO </b></td>
                                        <td><b>CODIGO </b></td>
                                        <td><b>BASE IMPONIBLE </b></td>
                                        <td><b>RETENCIONES % </b></td>
                                        <td><b>VALOR </b></td>
                                    </tr>
                                    <tr ng-repeat="detail in vm.retention.items">
                                        <td>{{vm.retention.ejercicioFiscal}}</td>
                                        <td>{{detail.codigo}}</td>
                                        <td>{{detail.codigo_porcentaje_integridad}}</td>
                                        <td>{{detail.base_imponible}}</td>
                                        <td>{{detail.porcentaje}}</td>
                                        <td>{{detail.valor_retenido}}</td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td><b>TOTAL</b></td>
                                        <td>{{vm.totalRetention}}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        
    <div id="modalBaseImponible" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.impuesto=undefined">&times;</button>
                    <h4 class="modal-title">Base Imponible</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3"  ng-if="vm.item.codigo === 1">
                            <b>Retenci&oacute;n en la Fuente</b>
                        </div>
                        <div class="col-md-3"  ng-if="vm.item.codigo === 2">
                            <b>Retenci&oacute;n del IVA</b>
                        </div>
                        <div class="col-md-3" >
                            C&oacute;digo: <b>{{vm.item.codigo_porcentaje}}</b>
                        </div>
                        <div class="col-md-3" >
                            Retenci&oacute;n %: <b>{{vm.item.porcentaje}}</b>
                        </div>
                        <div class="col-md-3" >
                            <label>Valor</label>
                            <input type="text" onkeypress="return ((event.which >= 46 && event.which <= 57) || (event.keyCode == 9 || event.keyCode == 8))"
                            class="form-control" maxlength="9" ng-model="vm.item.base_imponible">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" title = "Aceptar" class="btn btn-success btn-sm" data-dismiss="modal" ng-click="vm.addItem()">
                            <span class = "glyphicon glyphicon-thumbs-up" aria-hidden = "true"></span>
                    </button>
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm"  data-dismiss="modal"
                            ng-click="vm.item = undefined; vm.indexEdit = undefined;">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
      
    <!--ELIMINAR PROVEEDOR-->
    <div id="modalEliminar" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.provider=undefined">&times;</button>
                    <h4 class="modal-title">Advertencia</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12" >
                            Esta seguro que desea Eliminar el Proveedor: {{vm.provider.name}}
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" title = "Eliminar Proveedor" class="btn btn-primary btn-sm" ng-click="vm.remove()" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-trash" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!--ANULAR RETENCIÃN-->
    <div id="modalAnularRetention" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.client=undefined">&times;</button>
                    <h3 class="modal-title">Â¡Â¡Â¡Advertencia!!!</h3>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12" >
                            <p>Â¿Est&aacute; seguro que desea Anular la Retenci&oacute;n <b>No. {{vm.deactivateRetention.stringSeq}}</b>?</p>
                            <p>Recuerde que la Retenci&oacute;n Anulada <b>NO puede ser Recuperada</b></p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" title="Anular RetenciÃ³n" class="btn btn-danger btn-sm" ng-click="vm.retentionDeactivate()" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-screenshot" aria-hidden = "true"></span>
                    </button>
                    <button type="button" title = "Salir" class="btn btn-primary btn-sm" data-dismiss="modal">
                            <span class = "glyphicon glyphicon-log-out" aria-hidden = "true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!--FIN DEL MODULO DE RETENCIONES-->
</div>