function routes(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"vm"}).when("/activate/:idUSer/:validate",{templateUrl:"views/activate/activate.tpl.html",controller:"ActivateCtrl",controllerAs:"vm"}).when("/home",{templateUrl:"views/home/home.tpl.html",controller:"HomeCtrl",controllerAs:"vm"}).when("/users",{templateUrl:"views/users/users.tpl.html",controller:"UsersCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}var app=angular.module("integridadUiApp",["app.routes","app.core","app.directives"]);angular.module("app.routes",["ngRoute"]).config(routes),routes.$inject=["$routeProvider"],angular.module("app.services",["base64"]),angular.module("app.core",["app.services","ui.bootstrap","ngResource","toaster","ngAnimate","ngStorage","angularUtils.directives.dirPagination"]),angular.module("app.directives",["ngPatternRestrict"]),angular.module("integridadUiApp").controller("MainCtrl",["$rootScope","$location","authService","utilValidationService","permissionService","$localStorage",function(a,b,c,d,e,f){function g(){e.getPermissions(f.user.userType).then(function(c){f.permissions=c,a.updateMenu(),h.loading=!1,b.path("/home")})["catch"](function(a){h.loading=!1,h.error=a.data})}var h=this;h.loading=!1,h.init=!0,h.recover=!1,h.userIntegridad={},h.error=void 0,h.success=void 0,h.login=function(){h.loading=!0;var a={email:h.email,password:h.password};c.authUser(a).then(function(a){f.user=a,g()})["catch"](function(a){h.loading=!1,h.error=a.data})},h.register=function(){h.userIntegridad.birthDay=$("#pickerBirthday").data("DateTimePicker").date().toDate().getTime(),h.userIntegridad.email=h.userIntegridad.email.trim(),h.userIntegridad.password=h.userIntegridad.password.trim();var a=d.isAnyInArrayStringEmpty([h.userIntegridad.email,h.userIntegridad.password,h.userIntegridad.firstName,h.userIntegridad.lastName]);a?h.error="Debe ingresar Nombres completos, email y password":(a=d.isStringEmpty(h.userIntegridad.cedula)&&d.isStringEmpty(h.userIntegridad.ruc),a&&(h.error="Debe ingresar un numero de cedula o ruc")),a||(h.loading=!0,c.registerUser(h.userIntegridad).then(function(a){h.loading=!1,h.error=void 0,h.init=!0,h.success="Resgistro realizado con exito. Se envio un email a la cuenta registrada para activar su cuenta"})["catch"](function(a){h.loading=!1,h.error=a.data}))},h.recoverPass=function(){h.loading=!0;var a={email:h.email};c.recoverUser(a).then(function(a){h.loading=!1,h.recover=!1,h.success="Se envio un email a la cuenta registrada con un nuevo Password para ingresar al sistema."})["catch"](function(a){h.loading=!1,h.error=a.data})}}]),angular.module("integridadUiApp").controller("MenuCtrl",["$rootScope","$scope","$localStorage","$location",function(a,b,c,d){b.permissions=[],a.updateMenu=function(){b.permissions=c.permissions,b.nameType=c.user.firstName+" - "+c.user.userType.name},b.logout=function(){b.permissions=[],b.nameType=void 0,c.permissions=void 0,c.user=void 0,d.path("/")},c.permissions&&a.updateMenu()}]),angular.module("integridadUiApp").controller("ActivateCtrl",["$routeParams","$location","authService",function(a,b,c){var d=this;d.errorActive=!1,c.activeUser(a.idUSer,a.validate).then(function(a){b.path("/home")})["catch"](function(a){d.errorActive=!0,d.error=a.data})}]),angular.module("integridadUiApp").controller("HomeCtrl",function(){}),angular.module("integridadUiApp").controller("UsersCtrl",["utilStringService","utilValidationService","userTypeService","authService",function(a,b,c,d){function e(){f.loading=!0,c.getUserTypes().then(function(a){f.userTypes=a,f.loading=!1})["catch"](function(a){f.loading=!1,f.error=a.data})}var f=this;f.loading=!1,f.userIntegridad={},f.register=function(){f.userIntegridad.birthDay=$("#pickerBirthday").data("DateTimePicker").date().toDate().getTime(),f.userIntegridad.email=f.userIntegridad.email.trim(),f.userIntegridad.password=a.randomString();var c=b.isAnyInArrayStringEmpty([f.userIntegridad.email,f.userIntegridad.password,f.userIntegridad.firstName,f.userIntegridad.lastName]);c?f.error="Debe ingresar Nombres completos y un email":(c=b.isStringEmpty(f.userIntegridad.cedula)&&b.isStringEmpty(f.userIntegridad.ruc),c&&(f.error="Debe ingresar un numero de cedula o ruc")),c||(f.loading=!0,d.registerUser(f.userIntegridad).then(function(a){f.loading=!1,f.error=void 0,f.success="Resgistro realizado con exito. Se envio un email a la cuenta registrada para activar su cuenta"})["catch"](function(a){f.loading=!1,f.error=a.data}))},function(){e()}()}]),angular.module("app.services").service("securityService",["$http","$base64",function(a,b){var c="https://integridad.herokuapp.com/integridad/v1",d={},e=b.encode("dan:12345");d.headers={"Content-Type":"application/json",Authorization:"Basic "+e},this.get=function(b){return a.get(c+b)},this["delete"]=function(b){return a["delete"](c+b)},this.post=function(b,e){var f=c+b;return a.post(f,e,d)},this.put=function(b,e){var f=c+b;return a.put(f,e,d)}}]),angular.module("app.services").service("utilValidationService",function(){this.isStringEmpty=function(a){return a?!1:!0},this.isAnyInArrayStringEmpty=function(a){for(var b,c=0;c<a.length;c++){if(!a[c]){b=!0;break}b=!1}return b}}),angular.module("app.services").service("utilStringService",function(){this.isStringEmpty=function(a){return a?!1:!0},this.isAnyInArrayStringEmpty=function(a){for(var b,c=0;c<a.length;c++){if(!a[c]){b=!0;break}b=!1}return b},this.randomString=function(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;5>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}}),angular.module("app.services").service("authService",["securityService",function(a){this.authUser=function(b){return a.post("/user/auth",b).then(function(a){return a.data})},this.registerUser=function(b){return a.post("/user",b).then(function(a){return a.data})},this.activeUser=function(b,c){return a.put("/user/"+b+"/"+c).then(function(a){return a.data})},this.recoverUser=function(b){return a.post("/user/recover",b).then(function(a){return a.data})}}]),angular.module("app.services").service("permissionService",["securityService",function(a){this.getPermissions=function(b){return a.post("/user_type_permission/user_type",b).then(function(a){return a.data})}}]),angular.module("app.services").service("userTypeService",["securityService",function(a){this.getUserTypes=function(){return a.get("/user_type/lazy").then(function(a){return a.data})}}]),angular.module("integridadUiApp").run(["$templateCache",function(a){"use strict";a.put("views/activate/activate.tpl.html",'<div class="panel panel-default"> <div class="panel-body"> <div class="row" ng-show="vm.errorActive"> <div class="form-group col-md-12"> <div class="alert alert-danger">{{vm.error}}</div> </div> </div> </div> </div>'),a.put("views/home/home.tpl.html",'<div class="panel panel-default"> <div class="panel-body"> <div class="row"> <div class="form-group col-md-12"> <h1>HOLA HOLA <br> Gracias por ingresar al Sistema Integridad</h1> </div> </div> </div> </div>'),a.put("views/main.html",'<div style="width: 100%;height: 100%;top: 0px;left: 0px;position: fixed;display: block; z-index: 99; background: rgba(255, 255, 255, 0.3)" ng-show="vm.loading"> <div style="position: absolute;top: 15%;z-index: 100; width: 100%; text-align: center"> <div class="sk-circle"> <div class="sk-circle1 sk-child"></div> <div class="sk-circle2 sk-child"></div> <div class="sk-circle3 sk-child"></div> <div class="sk-circle4 sk-child"></div> <div class="sk-circle5 sk-child"></div> <div class="sk-circle6 sk-child"></div> <div class="sk-circle7 sk-child"></div> <div class="sk-circle8 sk-child"></div> <div class="sk-circle9 sk-child"></div> <div class="sk-circle10 sk-child"></div> <div class="sk-circle11 sk-child"></div> <div class="sk-circle12 sk-child"></div> </div> </div> </div> <div class="row" ng-show="vm.init"> <div class="col-md-8 col-md-offset-2"> <img src="images/zolutions1.36c9be71.jpg"><br> </div> </div> <div class="panel panel-default" ng-show="vm.init && !vm.recover"> <div class="panel-body"> <div class="row" ng-show="vm.error !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-danger">{{vm.error}}</div> </div> </div> <div class="row" ng-show="vm.success !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-success">{{vm.success}}</div> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>E-mail: </label> <input type="text" ng-model="vm.email" class="form-control"> </div> <div class="form-group col-md-6"> <label>Password: </label> <input type="password" ng-model="vm.password" class="form-control"> </div> </div> </div> <div class="panel-footer"> <button type="button" class="btn btn-primary" ng-click="vm.login()" ng-disabled="vm.email === undefined || vm.password === undefined"> Ingresar </button> <button type="button" class="btn btn-success" ng-click="vm.init = false; vm.userIntegridad = {}; vm.success=undefined; vm.error=undefined"> Registrarse </button> <button type="button" class="btn btn-warning" ng-click="vm.recover = true; vm.success=undefined; vm.error=undefined"> Olvid&eacute; mi Password </button> </div> </div> <div class="panel panel-default" ng-show="vm.recover"> <div class="panel-body"> <div class="row" ng-show="vm.error !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-danger">{{vm.error}}</div> </div> </div> <div class="row" ng-show="vm.success !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-success">{{vm.success}}</div> </div> </div> <div class="row"> <div class="form-group col-md-12"> <label>Ingrese E-mail de la cuenta a recuperar: </label> <input type="text" ng-model="vm.email" class="form-control"> </div> </div> </div> <div class="panel-footer"> <button type="button" class="btn btn-primary" ng-click="vm.recoverPass()" ng-disabled="vm.email === undefined"> Recuperar </button> <button type="button" class="btn btn-success" ng-click="vm.recover = false; vm.userIntegridad = {}; vm.success=undefined; vm.error=undefined"> Cancelar </button> </div> </div> <div class="panel panel-default" ng-show="!vm.init"> <div class="panel-body"> <div class="row" ng-show="vm.error !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-danger">{{vm.error}}</div> </div> </div> <div class="row" ng-show="vm.success !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-success">{{vm.success}}</div> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Nombre *: </label> <input type="text" ng-model="vm.userIntegridad.firstName" class="form-control"> </div> <div class="form-group col-md-6"> <label>Apellido *: </label> <input type="text" ng-model="vm.userIntegridad.lastName" class="form-control"> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Tel&eacute;fono: (incluir c&oacute;digo de provincia ej: 02) </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.phone" class="form-control" maxlength="9"> </div> <div class="form-group col-md-6"> <label>Tel&eacute;fono celular: </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.celPhone" class="form-control" maxlength="10"> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Fecha de Nacimiento</label> <div class="input-group date" id="pickerBirthday"> <input type="text" class="form-control input-group-addon"> <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span> </div> <script>var defaultDate = new Date();\n          $(\'#pickerBirthday\').datetimepicker({\n            format: "DD/MM/YY",\n            defaultDate: defaultDate\n          });</script> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Tipo de Identificacion: </label> <select ng-options="item for item in [\'Cedula\', \'Ruc\']" ng-model="vm.typeId" class="form-control"></select> </div> <div class="form-group col-md-6" ng-show="vm.typeId === \'Cedula\'"> <label>C&eacute;dula *: </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.cedula" class="form-control" maxlength="10"> </div> <div class="form-group col-md-6" ng-show="vm.typeId === \'Ruc\'"> <label>Ruc *: </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.ruc" class="form-control" maxlength="13"> </div> </div> <div class="row"> <div class="form-group col-md-12"> <label>Direcci&oacute;n: </label> <input type="text" ng-model="vm.userIntegridad.address1" class="form-control"> </div> </div> <!-- <div class="row">\n      <div class="form-group col-md-12">\n        <label>Intersecci&oacute;n: </label>\n        <input type="text" ng-model="vm.userIntegridad.address2" class="form-control">\n      </div>\n    </div> --> <div class="row"> <div class="form-group col-md-6"> <label>E-mail *: </label> <input type="text" ng-model="vm.userIntegridad.email" class="form-control"> </div> <div class="form-group col-md-6"> <label>Password *: </label> <input type="password" ng-model="vm.userIntegridad.password" class="form-control"> </div> </div> </div> <div class="panel-footer"> <button type="button" class="btn btn-primary" ng-click="vm.register()" ng-disabled="vm.userIntegridad.email === undefined || vm.userIntegridad.password === undefined"> Registrar </button> <button type="button" class="btn btn-success" ng-click="vm.init = true; vm.userIntegridad = {}; vm.success=undefined; vm.error=undefined"> Cancelar </button> </div> </div>'),a.put("views/users/users.tpl.html",'<div style="width: 100%;height: 100%;top: 0px;left: 0px;position: fixed;display: block; z-index: 99; background: rgba(255, 255, 255, 0.3)" ng-show="vm.loading"> <div style="position: absolute;top: 15%;z-index: 100; width: 100%; text-align: center"> <div class="sk-circle"> <div class="sk-circle1 sk-child"></div> <div class="sk-circle2 sk-child"></div> <div class="sk-circle3 sk-child"></div> <div class="sk-circle4 sk-child"></div> <div class="sk-circle5 sk-child"></div> <div class="sk-circle6 sk-child"></div> <div class="sk-circle7 sk-child"></div> <div class="sk-circle8 sk-child"></div> <div class="sk-circle9 sk-child"></div> <div class="sk-circle10 sk-child"></div> <div class="sk-circle11 sk-child"></div> <div class="sk-circle12 sk-child"></div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-body"> <div class="row" ng-show="vm.error !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-danger">{{vm.error}}</div> </div> </div> <div class="row" ng-show="vm.success !== undefined"> <div class="form-group col-md-12"> <div class="alert alert-success">{{vm.success}}</div> </div> </div> <div class="row"> <div class="form-group col-md-12"> <label>Tipo de Usuario *: </label> <select ng-options="userType as userType.name for userType in vm.userTypes  | orderBy:\'name\' track by userType.id" ng-model="vm.userIntegridad.userType" class="form-control"> </select> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Nombre *: </label> <input type="text" ng-model="vm.userIntegridad.firstName" class="form-control"> </div> <div class="form-group col-md-6"> <label>Apellido *: </label> <input type="text" ng-model="vm.userIntegridad.lastName" class="form-control"> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Tel&eacute;fono: (incluir c&oacute;digo de provincia ej: 02) </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.phone" class="form-control" maxlength="9"> </div> <div class="form-group col-md-6"> <label>Tel&eacute;fono celular: </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.celPhone" class="form-control" maxlength="10"> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Fecha de Nacimiento</label> <div class="input-group date" id="pickerBirthday"> <input type="text" class="form-control input-group-addon"> <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span> </div> <script>var defaultDate = new Date();\n          $(\'#pickerBirthday\').datetimepicker({\n            format: "DD/MM/YY",\n            defaultDate: defaultDate\n          });</script> </div> </div> <div class="row"> <div class="form-group col-md-6"> <label>Tipo de Identificacion: </label> <select ng-options="item for item in [\'Cedula\', \'Ruc\']" ng-model="vm.typeId" class="form-control"></select> </div> <div class="form-group col-md-6" ng-show="vm.typeId === \'Cedula\'"> <label>C&eacute;dula *: </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.cedula" class="form-control" maxlength="10"> </div> <div class="form-group col-md-6" ng-show="vm.typeId === \'Ruc\'"> <label>Ruc *: </label> <input type="text" onkeypress="return event.charCode >= 48 && event.charCode <= 57" ng-model="vm.userIntegridad.ruc" class="form-control" maxlength="13"> </div> </div> <div class="row"> <div class="form-group col-md-12"> <label>Direcci&oacute;n: </label> <input type="text" ng-model="vm.userIntegridad.address1" class="form-control"> </div> </div> <!-- <div class="row">\n      <div class="form-group col-md-12">\n        <label>Intersecci&oacute;n: </label>\n        <input type="text" ng-model="vm.userIntegridad.address2" class="form-control">\n      </div>\n    </div> --> <div class="row"> <div class="form-group col-md-12"> <label>E-mail *: </label> <input type="text" ng-model="vm.userIntegridad.email" class="form-control"> </div> </div> </div> <div class="panel-footer"> <button type="button" class="btn btn-primary" ng-click="vm.register()" ng-disabled="vm.userIntegridad.email === undefined"> Registrar </button> <button type="button" class="btn btn-success" ng-click="vm.userIntegridad = {}; vm.success=undefined; vm.error=undefined"> Cancelar </button> </div> </div>')}]);